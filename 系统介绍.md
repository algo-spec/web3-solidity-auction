## 1. ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»ŸåŸºäºSolidityè¯­è¨€å¼€å‘çš„ä»¥å¤ªåŠNFTæ‹å–æ™ºèƒ½åˆçº¦

### 1.1 ç³»ç»ŸåŠŸèƒ½
- âœ… NFTæ‹å–ç®¡ç†
- âœ… ä»·æ ¼é¢„è¨€æœºé›†æˆ
- âœ… æ‹å–åˆçº¦ã€å·¥å‚åˆçº¦å®‰å…¨å¯å‡çº§æ€§
- âœ… å·¥å‚æ¨¡å¼éƒ¨ç½²
- âœ… å¤šä»£å¸æ”¯æŒã€ETH/ERC20ã€‘
- âŒ è·¨é“¾ç«æ‹ã€CCIPã€‘
  
### 1.2 é¡¹ç›®ç»“æ„
```
web3-solidity-auction
â”œâ”€ ğŸ“contracts
â”‚  â”œâ”€ ğŸ“mock                                #æµ‹è¯•mockåˆçº¦ç›®å½•                
â”‚  â”‚  â”œâ”€ ğŸ“„AggregatorV3.sol                 #è¯­è¨€æœº
â”‚  â”‚  â”œâ”€ ğŸ“„MockERC20.sol                    #mock ERC20åˆçº¦
â”‚  â”‚  â””â”€ ğŸ“„MockERC721.sol                   #mock ERC721åˆçº¦
â”‚  â”œâ”€ ğŸ“„NftAuction.sol                      #æ‹å–åˆçº¦å®ç°
â”‚  â”œâ”€ ğŸ“„NftAuctionFactory.sol               #æ‹å–å·¥å‚åˆçº¦
â”‚  â””â”€ ğŸ“„NftAuctionV2.sol                    #æ‹å–åˆçº¦å‡çº§ç‰ˆæœ¬
â”œâ”€ ğŸ“deploy                                 #éƒ¨ç½²è„šæœ¬ç›®å½•
â”‚  â”œâ”€ ğŸ“.cache                              #å…ƒæ•°æ®ç›®å½•
â”‚  â”‚  â””â”€ ğŸ“„proxyNftAuctionFactory.json      #å…ƒæ•°æ®
â”‚  â”œâ”€ ğŸ“„01_deploy_auction.js                #æ‹å–åˆçº¦éƒ¨ç½²è„šæœ¬
â”‚  â”œâ”€ ğŸ“„01_deploy_auctionFactory.js         #å·¥å‚åˆçº¦éƒ¨ç½²è„šæœ¬
â”‚  â””â”€ ğŸ“„02_upgrade_auction.js               #å‡çº§åˆçº¦éƒ¨ç½²è„šæœ¬
â”œâ”€ ğŸ“test                                   #æµ‹è¯•è„šæœ¬ç›®å½•
â”‚  â””â”€ ğŸ“„test_auction.js                     #æµ‹è¯•è„šæœ¬
```

### 1.3 æŠ€æœ¯æ ˆ
- **åˆçº¦è¯­è¨€**: Solidity
- **å¼€å‘æ¡†æ¶**: Hardhat
- **æµ‹è¯•æ¡†æ¶**: Mocha
- **è¯­è¨€æœº**: Chainlink Data Feeds
- **ä»£ç†æ¨¡å¼**: OpenZeppelin UUPS
- **è·¨é“¾åè®®**: CCIP

## 2. åˆçº¦ä»‹ç»

### 2.1 NftAuction.sol 

#### åŠŸèƒ½æè¿°
NftAuction.sol æ˜¯ä¸€ä¸ª NFT æ‹å–åˆçº¦ï¼Œç”¨äºå®ç° NFT çš„æ‹å–åŠŸèƒ½ã€‚è¯¥åˆçº¦ä½¿ç”¨ OpenZeppelin çš„ UUPS ä»£ç†æ¨¡å¼ï¼Œå®ç°äº†å¯å‡çº§æ€§

#### æ‹å–åˆçº¦ç»“æ„ä½“
```solidity
struct Auction {
    address seller; // æ‹å–äººåœ°å€
    uint256 startTime; // èµ·æ‹æ—¶é—´
    uint256 duration; // æ‹å–æŒç»­æ—¶é—´
    uint256 startPrice; // èµ·æ‹ä»·æ ¼
    uint256 highestBid; // æœ€é«˜å‡ºä»·
    address highestBidder; // æœ€é«˜å‡ºä»·äººåœ°å€
    bool ended; // æ˜¯å¦ç»“æŸ
    address nftContract; // NFTåˆçº¦åœ°å€
    uint256 tokenId; // NFTä»£å¸ID
    address tokenAddress; // ç«æ‹ä»£å¸åœ°å€
}
```

#### å‡½æ•°åˆ—è¡¨
```solidity
// æ‹å–
function setAuctionParams(
        address _nftContract,
        uint256 _tokenId,
        uint256 _startPrice,
        uint256 _duration
    )

function bid(address _tokenAddress, uint256 _amount)
function endAuction()
function getAuctionInfo()

// è¯­è¨€æœº
function setPriceFeed(address _nftAddress, address _priceFeed) 
function getLatestPrice(address _tokenAddress)
```

### 2.2 NftAuctionV2.sol

#### åŠŸèƒ½æè¿°
NftAuctionV2.sol æ˜¯ NftAuction æ‹å–åˆçº¦çš„å‡çº§ç‰ˆæœ¬ï¼Œä¸»è¦ç”¨äºæµ‹è¯•åˆçº¦å‡çº§

#### æ–°å¢å‡½æ•°
```solidity
function hello() 
```

### 2.3 NftAuctionFactory.sol

#### åŠŸèƒ½æè¿°
NftAuctionFactory.sol æ˜¯ NftAuction æ‹å–åˆçº¦çš„å·¥å‚åˆçº¦ï¼Œä¸»è¦ç”¨äºåˆ›å»ºæ–°çš„ NftAuction åˆçº¦å®ä¾‹

#### å‡½æ•°åˆ—è¡¨
```solidity
function createAuction(
        address nftAddress,
        uint256 tokenId,
        uint256 startPrice,
        uint256 duration
    )
function getAuctions()
function updateAuctionImplementation(
        address _newAuctionImplementation
    )
```

## 3. æµ‹è¯•è„šæœ¬
æµ‹è¯•è„šæœ¬ä½äº `test/test_auction.js` æ–‡ä»¶ä¸­ï¼Œè¯¥è„šæœ¬ä¸»è¦æµ‹è¯•äº† NftAuctionFactory çš„åˆ›å»ºæ‹å–åˆçº¦å’ŒæŸ¥è¯¢æ‹å–åˆçº¦çš„åŠŸèƒ½

### 3.1 æµ‹è¯•ç»“æœ
![alt text](image-3.png)
![alt text](image-4.png)